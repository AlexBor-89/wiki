---
title: Функция ВПР в Excel — пошаговая инструкция с 5 примерами
description: 
published: true
date: 2024-11-01T13:49:41.782Z
tags: 
editor: markdown
dateCreated: 2024-10-31T09:17:07.906Z
---

ВПР - это функция Excel для поиска и извлечения данных из определенного столбца в таблице. Она поддерживает приблизительное и точное сопоставление, а также подстановочные знаки (* и ?). Значения поиска должны отображаться в первом столбце таблицы, а столбцы поиска находятся правее.

Давайте теперь рассмотрим, как сделать поиск с ВПР и как она работает. Ниже смотрите примеры ее применения в формулах Excel.

# Как сделать ВПР в Excel: понятная пошаговая инструкция
Для начала на простом примере разберем, как работает функция ВПР в Excel. Предположим, у нас есть две таблицы. Первая – это прайс-лист с наименованиями и ценами. Вторая – это заказ на покупку некоторых из этих товаров. Искать в прайс листе нужный товар и руками вписывать в заказ его цену – занятие очень утомительное. Ведь прайс с ценами может насчитывать сотни строк. Нам необходимо сделать всё автоматически.

Нам необходимо обнаружить интересующее нас наименование в первом столбце и возвратить (то есть показать в ответ на наш запрос) содержимое из желаемого столбца той же строки, где находится наименование.

Наш прайс-лист расположен в столбцах А и В. Список покупок – в E-H. Допустим, первая позиция в списке покупок – бананы. Нам нужно в столбце A, где указаны все наименования, найти этот товар, затем его цену поместить в ячейку G2.

![Функция_ВПР_в_Excel_пошаговая_инструкция 01](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/01.png ""){.align-center}

Для этого в G2 запишем следующую формулу:
> =ВПР(E2;\$A\$2:\$B\$7;2;0) {.is-success}

А теперь разберем подробно, как сделать ВПР.

1. Мы берём значение из E2.
2. Ищем точное совпадение (поскольку четвертым параметром указан 0) в диапазоне \$A\$2:\$B\$7 в первой его колонке (крайней левой). Обратите внимание, что лучше сразу же использовать абсолютные ссылки на прайс-лист, чтобы при копировании этой формулы ссылка не «соскользнула».
3. Если товар будет найден, то нужно перейти во второй столбец диапазона (на это указывает третий параметр = 2).
4. Взять из него цену и вставить ее в нашу ячейку G2.

![Функция_ВПР_в_Excel_пошаговая_инструкция 02](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/02.png ""){.align-center}

Получилось? Теперь просто скопируйте формулу из G2 в G3:G8.

![Функция_ВПР_в_Excel_пошаговая_инструкция 03](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/03.png ""){.align-center}

Отчет о продажах готов.

Также чтобы понять, что такое точное совпадение, попробуйте в A5 или в E2 изменить наименование товара. К примеру, добавьте пробел в конце. Внешне ничего не изменилось, но вы сразу же получите ошибку `#Н/Д`. То есть, товар не был обнаружен. В то же время, таких случайных ошибок можно легко избежать, о чем мы поговорим отдельно.

Особо остановимся на четвертом параметре. Мы указали ноль (можно было написать ЛОЖЬ), что означает "точный поиск". А что, если забыть его указать и закончить номером столбца, из которого извлекаются нужные данные?

Давайте ещё раз шаг за шагом разберем, что в этом случае будет происходить.

![Функция_ВПР_в_Excel_пошаговая_инструкция 04](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/04.png ""){.align-center}

1. Берём значение из E2.
2. Начинаем его искать в крайней левой колонке диапазона \$A\$2:\$B\$7, то есть в столбце A. Поскольку в A2 совпадение не найдено, смотрим дальше: что находится ниже.
3. Там обнаруживаем товар «Сливы». При этом предполагается, что наш список отсортирован по алфавиту. Ведь именно это – главное условие поиска приблизительного совпадения.
4. Поскольку в сортированном списке «сливы» находятся ниже, чем «бананы», то функция принимает решение, что дальше искать слово, начинающееся на «Б» нет смысла. Процесс можно остановить. И остаться на букве "А". То есть, там и находится наиболее близкое значение.
5. Поскольку поиск завершен, переходим из A2 во второй столбец, то есть в B. Вставляем данные из B2 в G2 как результат вычислений.

К сожалению, «бананы» были в нашем прайс-листе ниже, но до них просто «не дошел ход». И в список покупок теперь записана неправильная цена.

При помощи этой инструкции мы рассмотрели только основы. А как реально этим можно пользоваться?

# Как работает функция ВПР в Excel: несколько примеров
Предположим, нам необходимо из списка сотрудников выбрать данные определенного человека. Посмотрим, какие здесь есть тонкости.

Во-первых, нужно сразу определиться: точный либо приблизительный поиск нам нужен. Ведь они предъявляют разные требования к подготовке исходных данных.

## Использование точного и приблизительного поиска
Посмотрите, какие результаты выборки цен мы получаем с использованием приблизительного поиска на неупорядоченном массиве данных.

![Функция_ВПР_в_Excel_пошаговая_инструкция 05](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/05.png ""){.align-center}

Обратите внимание, что четвертый параметр равен 1.

Кое-что из результатов определено верно, но в большинстве случаев – ошибки. Функция продолжает просматривать данные столбца D с наименованиями товаров до тех пор, пока не встретит значение больше, чем заданное ей в качестве критерия поиска. Тогда она останавливается и возвращает цену.

Поиск цены на египетские бананы закончился на первой же позиции, так как во второй записаны сливы. А это слово по правилам алфавита стоит ниже, чем «Бананы Египет». Значит, дальше искать не нужно. Получили 145. И не важно, что это цена абрикосов. Поиск цены на сливы происходил до тех пор, пока в D15 не встретилось слово, которое по алфавиту стоит ниже: яблоки. Остановились и взяли цену из предыдущей строки.

А теперь взгляните, как должно было все происходить, если все делать верно. Всего лишь делаем сортировку, как указано стрелкой.

![Функция_ВПР_в_Excel_пошаговая_инструкция 06](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/06.png ""){.align-center}

Вы спросите: «А зачем тогда этот неточный просмотр, если с ним столько проблем?»

Он отлично подходит для выбора значений из определенных интервалов.

Допустим, у нас установлена скидка для покупателей в зависимости от количества приобретенного товара. Нужно быстро рассчитать, сколько процентов положено на совершенную покупку.

![Функция_ВПР_в_Excel_пошаговая_инструкция 07](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/07.png ""){.align-center}

Если у нас количество товара 11 единиц, то мы просматриваем столбец D до тех пор, пока не встретим число, большее 11. Это 20 и находится оно в 4-й строке. Останавливаемся здесь. Значит, наша скидка расположена в 3-й строке и равна 3%.

При работе с интервалами вида «от – до» такая методика вполне пригодна.

И еще один небольшой совет.

## Применяйте именованный диапазон.
![Функция_ВПР_в_Excel_пошаговая_инструкция 08](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/08.png ""){.align-center}

Для упрощения работы с формулами можно создать именованный диапазон и в дальнейшем ссылаться на него. В нашем случае назовем его «ДанныеСотрудников» (помните, что пробелы здесь недопустимы).

В ячейке B2 мы будем вводить нужную фамилию, а в ячейках С2:F2 запишем формулы:
> =ВПР(\$B\$2;ДанныеСлужащего;2;ЛОЖЬ) {.is-success}

> =ВПР(\$B\$2;ДанныеСлужащего;3;ЛОЖЬ) {.is-success}

> =ВПР(\$B\$2;ДанныеСлужащего;4;ЛОЖЬ) {.is-success}

> =ВПР(\$B\$2;ДанныеСлужащего;5;ЛОЖЬ) {.is-success}

Как видите, отличаются они только номером столбца, из которого будет извлечена нужная информация. Вместо ЛОЖЬ можно использовать 0.

Какие здесь преимущества?

1. У вас не рябит в глазах от букв, цифр и знаков доллара в обычных адресах диапазонов?

Формула с именованным диапазоном выглядит намного более дружественно, наглядно и понятно. Вместо скучных и безликих координат вы видите идентификаторы, которые рождают у вас некоторые ассоциации. Согласитесь, “price” или «цена» – это наверняка информация о ценах.

2. Если по каким-то причинам вам необходимо будет изменить координаты диапазона поиска, который вы использовали в большом количестве формул – вам нужно корректировать каждую формулу или пользоваться функцией “Найти и заменить”? Согласитесь, это очень долго, трудоемко, возможны ошибки.

Используя именованный диапазон, просто нажмите

Меню – Формула – Диспетчер имён.

Затем в списке диапазонов найдите нужный вам диапазон и откорректируйте его. Изменения автоматически будут применены во всех формулах.

3. Используя обычные адреса, мы всегда должны думать, какую адресацию применить – относительную либо абсолютную. При использовании именованных диапазонов этой проблемы не существует.

## Использование символов подстановки и другие тонкости критерия поиска
Как и в предыдущих примерах, при вводе фамилии происходит точный поиск. Но есть несколько моментов, о которых мы ранее не упоминали.

1. Регистр символов не влияет на результат. Можно все вводить прописными буквами – ничего не изменится. Пример вы видите чуть ниже.

![Функция_ВПР_в_Excel_пошаговая_инструкция 09](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/09.png ""){.align-center}

2. Если в списке есть люди с одинаковыми фамилиями, то найден будет только первый из них. Как и мы говорили ранее, как только найдено что-то подходящее, процесс останавливается.
3. Можно использовать символы подстановки * и ?. Напомню, что вопросительный знак заменяет собой любой символ, а звездочка – любое количество символов (в том числе и ноль). О них мы упоминали в начале.

Это целесообразно делать, если мы знаем только часть значения аргумента.

![Функция_ВПР_в_Excel_пошаговая_инструкция 10](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/10.png ""){.align-center}

Но при этом будьте внимательны – снова будет найдено только первое подходящее совпадение, как это показано на скриншоте. Это очень важное ограничение, которое нужно обязательно учитывать.

Теперь давайте посмотрим, как можно работать с символами подстановки, если условия отбора не вводятся вручную, а берутся из таблицы Excel.

![Функция_ВПР_в_Excel_пошаговая_инструкция 11](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/11.png ""){.align-center}

Формула в ячейке F2 выглядит следующим образом:
> =ВПР("\*"&D2&"\*";\$A\$2:\$B\$7;2;0) {.is-success}

Здесь мы используем оператор «склеивания» строк &.

Конструкция **"\*"&D2&"\*"** означает, что к содержимому ячейки D2 добавляются с обоих сторон звездочки \*. То есть, мы ищем любое вхождение этого слова – перед ним и после него могут быть любые другие слова и символы. Как, например, произошло с товаром «персики». Первый параметр будет в нашем случае выглядеть как «*персики*». При поиске такой конструкции приемлемым вариантом будут определены «Консервированные **персики** (Турция)».

## Использование нескольких условий
Ещё один простой пример для «чайников» - как использовать при выборе нужного значения несколько условий?

Предположим, у нас есть список имен и фамилий. Нам нужно найти нужного человека и вывести сумму его дохода.

![Функция_ВПР_в_Excel_пошаговая_инструкция 12](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/12.png ""){.align-center}

В F2 используем следующую формулу:
> =ВПР(D2&" "&E2;\$A\$2:\$B\$21;2;0) {.is-success}

Разберём пошагово, как в этом случае работает ВПР.

В начале мы формируем условие. Для этого при помощи оператора & «склеиваем» вместе имя и фамилию, а между ними вставляем пробел.

Не забываем при этом пробел заключить в кавычки, иначе Excel не воспримет его как текст.

Затем в таблице с доходами ищем ячейку с именем и фамилией, разделенными пробелом.

Дальше все происходит по уже отработанной схеме.

Можно попробовать подстраховаться на тот случай, если между именем и фамилией введено несколько пробелов. Знак пробела в формуле заменяем на знак подстановки «\*».

Приметно так - **D2&"\*"&E2**

Но при этом имейте в виду, что совпадение имени и фамилии уже будет не совсем точным. Подобный пример мы рассматривали чуть выше.

Более сложные и точные способы работы с несколькими условиями мы рассмотрим отдельно: [ВПР с несколькими условиями: 5 примеров](/).

## ВПР в таблице Excel
И ещё одна рекомендация: используйте «умную» таблицу.

![Функция_ВПР_в_Excel_пошаговая_инструкция 13](/ИТ/Excel/ВПР/Функция_ВПР_в_Excel_пошаговая_инструкция/13.png ""){.align-center}

Бывает очень удобно сначала преобразовать поисковую таблицу (прайс-лист) в «умную» с помощью команды Главная – Форматировать как таблицу (Home – Format as Table в английской версии Excel), и затем указать во втором аргументе использовать имя созданной таблицы. Кстати, оно ей будет присвоено автоматически.

В этом случае размеры списка товаров с ценами нас уже не будут беспокоить в будущем. При добавлении новых товаров в прайс-лист, либо их удалении, размеры «умной таблицы» сами подстроятся.